---
interface Props {
  title: string;
  description?: string;
  image?: string;
  variant?: 'hero' | 'content';
}

const {
  title,
  description = "deja is an open source Cloudflare Worker that gives agents durable recall. Store, query, and inject learnings with precision.",
  image = "/meta.jpg",
  variant = "hero"
} = Astro.props;

const isContent = variant === 'content';

const canonicalURL = new URL(Astro.url.pathname, Astro.site ?? "https://deja.coey.dev");
const imageURL = new URL(image, canonicalURL);
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={imageURL} />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonicalURL} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={imageURL} />

    <link rel="canonical" href={canonicalURL} />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Spectral+SC:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">

    <!-- Page-specific SEO -->
    <slot name="head" />
  </head>
  <body class="m-0 relative min-h-screen">
    <!-- Header -->
    <header class="sticky top-0 z-10 backdrop-blur-md backdrop-saturate-50 bg-void/95 border-b border-brass/10 shadow-[0_1px_0_rgba(201,169,97,0.1)]">
      <div class="flex justify-between items-center px-6 py-4 max-w-[1160px] mx-auto">
        <a href="/" class="font-mono font-bold uppercase tracking-[0.32em] text-[11px] hover:text-brass transition-colors">deja</a>
        <nav class="flex items-center gap-[18px] text-[13px] text-chrome-dark">
          <a href="/integrations" class="hover:text-brass transition-colors">Integrations</a>
          <a href="/patterns" class="hover:text-brass transition-colors">Patterns</a>
          <a href="/docs" class="hover:text-brass transition-colors">Docs</a>
          <a href="/guides" class="hover:text-brass transition-colors hidden sm:inline">Guides</a>
          <a href="https://github.com/acoyfellow/deja" target="_blank" rel="noreferrer" class="hover:text-brass transition-colors">GitHub</a>
        </nav>
      </div>
    </header>

    <main class="relative z-1 max-w-[1160px] mx-auto px-6 pb-20">
      <slot />
    </main>

    {isContent ? (
      <div class="absolute inset-0 bg-void -z-10 pointer-events-none"></div>
    ) : (
      <>
        <div class="absolute top-0 left-0 right-0 h-[80vh] bg-cover bg-center bg-no-repeat -z-10 pointer-events-none" style="background-image: url('/orb.jpg');"></div>
        <div class="absolute top-[80vh] left-0 right-0 h-[200px] bg-linear-to-t from-void to-transparent -z-10 pointer-events-none"></div>

        <div class="absolute bottom-0 left-0 right-0 h-[60vh] bg-cover bg-center bg-no-repeat -z-10 pointer-events-none" style="background-image: url('/connected.jpg');"></div>
        <div class="absolute bottom-[40vh] left-0 right-0 h-[200px] bg-linear-to-b from-void to-transparent -z-10 pointer-events-none"></div>
      </>
    )}
  </body>
</html>

<style is:global>
  @import "../styles/global.css";
</style>
